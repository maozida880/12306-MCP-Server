# ============================================
# 12306-MCP-Server 环境变量配置
# ============================================
# 复制此文件为 .env 并根据需要修改配置
# cp .env.example .env

# ============================================
# Session Pool Configuration
# ============================================

# 最小会话池大小
# 建议: 开发环境 2, 生产环境 3-5
SESSION_POOL_MIN_SIZE=2

# 最大会话池大小
# 建议: 开发环境 5, 生产环境 8-10
# 注意: 过大可能导致资源浪费，过小可能导致请求排队
SESSION_POOL_MAX_SIZE=5

# 会话生存时间 (毫秒)
# 默认: 30分钟 (1800000ms)
# 建议: 根据12306策略调整，一般15-60分钟
SESSION_TTL=1800000

# 后台维护任务间隔 (毫秒)
# 默认: 5分钟 (300000ms)
# 建议: 不要低于1分钟，避免频繁检查
MAINTENANCE_INTERVAL=300000

# ============================================
# Retry Configuration
# ============================================

# 最大重试次数
# 默认: 3次
# 建议: 网络不稳定时可增加到5次
MAX_RETRIES=3

# 重试延迟 (毫秒)
# 默认: 1000ms (1秒)
# 采用指数退避: delay * attempt
RETRY_DELAY=1000

# ============================================
# API Configuration
# ============================================

# API请求超时 (毫秒)
# 默认: 10000ms (10秒)
# API_TIMEOUT=10000

# 最大并发请求数
# 默认: 3
# 建议: 根据服务器性能调整
# MAX_CONCURRENT_REQUESTS=3

# ============================================
# Logging Configuration
# ============================================

# 日志级别
# 可选值: error, warn, info, debug, trace
# 生产环境建议: info 或 warn
# 开发环境建议: debug
LOG_LEVEL=info

# 日志输出格式
# 可选值: json, simple, combined
LOG_FORMAT=simple

# 是否启用文件日志
# 默认: false (仅输出到控制台)
LOG_TO_FILE=false

# 日志文件路径
LOG_FILE_PATH=./logs/app.log

# 日志文件最大大小 (MB)
LOG_MAX_SIZE=10

# 日志文件保留数量
LOG_MAX_FILES=7

# ============================================
# Server Configuration
# ============================================

# HTTP模式的主机地址
# 默认: localhost
# 生产环境可设置为 0.0.0.0 监听所有接口
SERVER_HOST=localhost

# HTTP模式的端口
# 默认: 8080
SERVER_PORT=8080

# ============================================
# Monitoring Configuration
# ============================================

# 是否启用Prometheus指标
# 默认: false
ENABLE_METRICS=false

# Prometheus指标端口
# 默认: 9090
METRICS_PORT=9090

# 是否启用健康检查端点
# 默认: true
ENABLE_HEALTH_CHECK=true

# ============================================
# Performance Tuning
# ============================================

# Node.js 内存限制 (MB)
# 默认: 根据系统自动分配
# NODE_OPTIONS=--max-old-space-size=2048

# 是否启用请求缓存
# 默认: false
ENABLE_REQUEST_CACHE=false

# 缓存生存时间 (秒)
# 默认: 300 (5分钟)
CACHE_TTL=300

# ============================================
# Development Settings
# ============================================

# 开发模式
# 可选值: development, production, test
NODE_ENV=development

# 是否启用调试模式
# 启用后会输出更详细的日志
DEBUG=false

# 是否启用性能分析
# 启用后会记录请求耗时等指标
ENABLE_PROFILING=false

# ============================================
# Security Settings
# ============================================

# 是否启用请求签名验证
# 生产环境建议启用
ENABLE_REQUEST_SIGNATURE=false

# API密钥 (如果启用了签名验证)
# API_KEY=your-secret-key-here

# 是否启用IP白名单
# 启用后只允许白名单内的IP访问
ENABLE_IP_WHITELIST=false

# IP白名单 (逗号分隔)
# IP_WHITELIST=127.0.0.1,192.168.1.0/24

# ============================================
# Database (Optional)
# ============================================

# 如果需要持久化会话或统计数据
# DATABASE_URL=postgresql://user:password@localhost:5432/dbname
# REDIS_URL=redis://localhost:6379

# ============================================
# Third-party Services (Optional)
# ============================================

# Sentry错误追踪
# SENTRY_DSN=https://xxx@sentry.io/xxx

# New Relic APM
# NEW_RELIC_LICENSE_KEY=xxx

# ============================================
# Feature Flags
# ============================================

# 是否启用实验性功能
ENABLE_EXPERIMENTAL_FEATURES=false

# 是否启用断路器
ENABLE_CIRCUIT_BREAKER=false

# 断路器失败阈值
CIRCUIT_BREAKER_THRESHOLD=5

# 断路器超时时间 (毫秒)
CIRCUIT_BREAKER_TIMEOUT=60000

# ============================================
# 推荐配置组合
# ============================================

# === 开发环境 ===
# SESSION_POOL_MIN_SIZE=2
# SESSION_POOL_MAX_SIZE=5
# LOG_LEVEL=debug
# DEBUG=true

# === 生产环境 (小流量) ===
# SESSION_POOL_MIN_SIZE=3
# SESSION_POOL_MAX_SIZE=8
# LOG_LEVEL=info
# ENABLE_METRICS=true

# === 生产环境 (高流量) ===
# SESSION_POOL_MIN_SIZE=5
# SESSION_POOL_MAX_SIZE=15
# SESSION_TTL=3600000
# LOG_LEVEL=warn
# ENABLE_METRICS=true
# ENABLE_REQUEST_CACHE=true

# === 测试环境 ===
# SESSION_POOL_MIN_SIZE=1
# SESSION_POOL_MAX_SIZE=3
# LOG_LEVEL=debug
# NODE_ENV=test